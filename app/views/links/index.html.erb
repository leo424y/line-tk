<p id="notice"><%= notice %></p>

<% if params[:i] || params[:q]  %>
<% if @hili[:note].present? %>
<div class="my-1 mt-3 rounded-md shadow sm:mt-0">
  <a href="/"
    class="w-full flex items-center justify-center py-3 border border-transparent text-base font-medium rounded-md text-indigo-600 bg-white hover:bg-gray-50 md:py-4 md:text-lg ">
    <%= 'å†' if @hili[:url] %>è£½ä½œä¸€å€‹ HILI!
  </a>
</div>
<% if @hili[:url].present? %>
<p class="mt-3 text-lg text-gray-500">
<%= "#{@hili[:url]} å·²ç¸®å€ç‚º #{@hili[:full_url]}"%>
</p>
<p class="mt-3 text-lg text-gray-500">
  é»é¸ COPY å³å¯ä»¥è¤‡è£½åˆ°å‰ªè²¼ç°¿å›‰
</p>
<% else %>
<p class="mt-3 text-lg text-gray-500">
  æœ‰é€™å€‹å­—çš„ç›¸é—œç¶²å€ï¼Œé»é¸ Copy å³å¯ä»¥è¤‡è£½åˆ°å‰ªè²¼ç°¿å›‰
</p>
<% end %>

<div class="my-1 mt-3 rounded-md shadow sm:mt-0">
  <a href="#" onclick="copyToClipboard('<%= @hili[:full_url] %>')"
    class="w-full flex items-center justify-center py-3 border border-transparent text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 md:py-4 md:text-lg ">
    Copy</a>
</div>
<div class="my-1 mt-3 rounded-md shadow sm:mt-0">
  <a href="#" onclick="copyToClipboard('<%= "[#{@hili[:note]}](#{@hili[:full_url]})" %>')"
    class="w-full flex items-center justify-center py-3 border border-transparent text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-500 md:py-4 md:text-lg ">
    Copy as Markdown</a>
</div>
<p>
<%= @hili[:note] %> é€™å€‹å­—çš„ç›¸é—œé€£çµï¼š
</p>

<% all_links_markdown = '' %>
<% @links.each do |link| %>
  <% hili = "#{link.url}#:~:text=#{link.note}" %>
  <% all_links_markdown += "[#{link.note}](#{hili}) " %>
<% end %>
<div class="my-1 mt-3 rounded-md shadow sm:mt-0">
  <a href="#" onclick="copyToClipboard('<%= all_links_markdown %>')"
    class="w-full flex items-center justify-center py-3 border border-transparent text-base font-medium rounded-md text-indigo-600 bg-white hover:bg-gray-50 md:py-4 md:text-lg ">
    Copy all Hili links search result as Markdown</a>
</div>

<% @links.each do |link| %>
<% hili = "#{link.url}#:~:text=#{link.note}" %>
<%= link_to notify(link.note), hili, target: '_blank', style: "text-decoration:none; color:#{random_colors}" %>
<div class="my-1 mt-3 rounded-md shadow sm:mt-0">
  <a href="#" onclick="copyToClipboard('<%= hili %>')"
    class="w-full flex items-center justify-center py-3 border border-transparent text-base font-medium rounded-md text-indigo-600 bg-white hover:bg-gray-50 md:py-4 md:text-lg ">
    Copy</a>
</div>

<div class="my-1 mt-3 rounded-md shadow sm:mt-0">
  <a href="#" onclick="copyToClipboard('<%= "[#{link.note}](#{hili})" %>')"
    class="w-full flex items-center justify-center py-3 border border-transparent text-base font-medium rounded-md text-indigo-600 bg-white hover:bg-gray-50 md:py-4 md:text-lg ">
    Copy as Markdown</a>
</div>

<% end %>

<% else %>

<% end %>
<% else %>

<div>
  <div data-controller="autocomplete" data-autocomplete-url-value="/autocomplete_links">
    <%= search_form_for @q do |f| %>
    <%= f.search_field :url_or_note_cont, 'data-autocomplete-target': "input", required: true, class: "block border w-full pl-5 py-3 text-base rounded-md placeholder-gray-500 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:flex-1 border-gray-300", 'placeholder': 'æŸ¥è©¢æˆ–è£½ä½œçŸ­ç¶²å€â€¦', id: 'hiliit' %>
    <%= f.submit 'ğŸ¦« ğŸŒ³  HILI! ğŸŒ³ ğŸ¦«', name: nil, class: "my-1 w-full flex items-center justify-center py-3 border border-transparent text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 md:py-4 md:text-lg md:px-10" %>
    <div class="my-1 mt-3 rounded-md shadow sm:mt-0">
      <a onclick="tryIt('ğŸ¦«è¼¸å…¥ä½ æ¥è‘—ç¶²å€åœ¨é€™è£¡å¾Œåœ¨å‰è¼¸å…¥æ˜“è¯æƒ³çš„å­—ä¸¦é»æ“Šé€å‡ºhttps://hili.link')" href="#"
        class="w-full flex items-center justify-center py-3 border border-transparent text-base font-medium rounded-md text-indigo-600 bg-white hover:bg-gray-50 md:py-4 md:text-lg ">
        è£½ä½œç¯„ä¾‹
      </a>
    </div>
    <div class="my-1 mt-3 rounded-md shadow sm:mt-0">
      <a onclick="tryIt('è¼¸å…¥æ˜“è¯æƒ³çš„å­—ä¸¦é»æ“Šé€å‡º')" href="#"
        class="w-full flex items-center justify-center py-3 border border-transparent text-base font-medium rounded-md text-indigo-600 bg-white hover:bg-gray-50 md:py-4 md:text-lg ">
        æœå°‹ç¯„ä¾‹
      </a>
    </div>
    <%# f.label :url_or_note_cont %>
    <ul data-autocomplete-target="results"></ul>
    <% end %>
  </div>
</div>

<tbody>
  <% @links.each do |link| %>
  <tr>
    <td>
      <%= link_to notify(link.note), "#{link.url}#:~:text=#{link.note}", target: '_blank', style: "text-decoration:none; color:#{random_colors}" %>
    </td>
  </tr>
  <% end %>
</tbody>


<div class="relative py-10">
  <h3 class="text-2xl font-extrabold text-gray-900 tracking-tight sm:text-3xl">
    å¹«åŠ©é‡‘é­šè…¦å¿«é€Ÿè¨˜ä¸‹å¥½ç”¨é€£çµ
  </h3>
  <p class="mt-3 text-lg text-gray-500">
    åªéœ€è¦ä¸€å€‹æ­¥é©Ÿï¼Œå°±èƒ½å¿«é€Ÿå®Œæˆè¨˜éŒ„èˆ‡æŸ¥è©¢
  </p>

  <dl class="mt-10 space-y-10">
    <div class="relative">
      <dt>
        <div class="absolute flex items-center justify-center h-12 w-12 rounded-md bg-indigo-500 text-white">
          <!-- Heroicon name: outline/globe-alt -->
          <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9" />
          </svg>
        </div>
        <p class="ml-16 text-lg leading-6 font-medium text-gray-900">è£½ä½œé€£çµ</p>
      </dt>
      <dd class="mt-2 ml-16 text-base text-gray-500">
        <p>
          ğŸ¦« åœ¨ç¶²å€åˆ—è¼¸å…¥
          <code class='underline'>https://hili.link?i=è¦æ¨™è¨˜çš„å­—https://ä½ çš„é€£çµ</code>
        </p>
        <p>
          ğŸ¦« æˆ–åœ¨æœå°‹æ¡†è¼¸å…¥
          <code class='underline'>è¦æ¨™è¨˜çš„å­—https://ä½ çš„é€£çµ</code>
        </p>
        <p>
          ğŸ¦« æˆ–ç›´æ¥å°è‘— <a class='underline' href='https://line.me/R/ti/p/@460kalte'>Hili Chatbot</a> é€å‡ºä¸Šé¢æ¨™è¨˜çš„é€£çµä¹Ÿå¯ä»¥å¾—åˆ°çŸ­ç¶²å€
        </p>
      </dd>
    </div>

    <div class="relative">
      <dt>
        <div class="absolute flex items-center justify-center h-12 w-12 rounded-md bg-indigo-500 text-white">
          <!-- Heroicon name: outline/scale -->
          <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" />
          </svg>
        </div>
        <p class="ml-16 text-lg leading-6 font-medium text-gray-900">å–å¾—é€£çµ</p>
      </dt>
      <dd class="mt-2 ml-16 text-base text-gray-500">
        <p>
          ğŸ¦« åœ¨ç¶²å€åˆ—å…¥å°±èƒ½æŸ¥è©¢æƒ³æŸ¥çš„å­—ã€‚ä¾‹å¦‚ï¼š<code class='underline'>https://hili.link/æ˜“è¯æƒ³çš„å­—</code>
        </p>
        <p>
          ğŸ¦« æˆ–åœ¨æœå°‹æ¡†è¼¸å…¥
          <code class='underline'>è¦æŸ¥çš„å­—</code>
        </p>
        <p>
          ğŸ¦« æˆ–ç›´æ¥å°è‘— <a class='underline' href='https://line.me/R/ti/p/@460kalte'>Hili Chatbot</a> é€å‡ºå­—ä¹Ÿå¯å¾—åˆ°é€£çµ
        </p>
      </dd>
    </div>

    <div class="relative">
      <dt>
        <div class="absolute flex items-center justify-center h-12 w-12 rounded-md bg-indigo-500 text-white">
          <!-- Heroicon name: outline/lightning-bolt -->
          <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
        </div>
        <p class="ml-16 text-lg leading-6 font-medium text-gray-900">ç™¼ç¾æ›´å¤šé€£çµ</p>
      </dt>
      <dd class="mt-2 ml-16 text-base text-gray-500">
        ç›´æ¥è¼¸å…¥æƒ³æ‰¾çš„è³‡è¨Šï¼Œçœ‹çœ‹æœ‰ä»€éº¼æœ€æ–°é€£çµï¼
      </dd>
    </div>
  </dl>
</div>
<% end %>



<script type="text/javascript">
  function tryIt(e) {
    document.getElementById("hiliit").value = e
  }

  function copyToClipboard(message) {
    var textArea = document.createElement("textarea");
    textArea.value = message;
    textArea.style.opacity = "0";
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();


    try {
      var successful = document.execCommand('copy');
      var msg = successful ? 'successful' : 'unsuccessful';
      alert(textArea.value + ' å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼å¯ä»¥åˆ°è™•è²¼ä¸Šèˆ‡åˆ†äº«å›‰')
      //alert('Copying text command was ' + msg);
    } catch (err) {
      alert('Unable to copy value , error : ' + err.message);
    }

    document.body.removeChild(textArea);
  }
</script>
